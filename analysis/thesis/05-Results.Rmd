# Results of the iSEGMound Workflow

In this Master’s thesis two data preparation methods (DTm and Multi-Scale Topographic Index) and two segmentation methods (Watershed and Region Growing) were used and compared. The four workflows were tested on the Train DTM and the Train Area to understand the relationship between the size of the area of investigation and the variable settings of the respective algorithms. The most effective workflow was chosen to be applied to the five Areas of Interests: AoI 1, AoI 2, AoI 3, AoI 4 and AoI 5.

First let's have glimpse on the morphometric derivative chosen, the Multi-Scale Topographic Index, on the example of the Train DTM: 

```{r Figure 67, echo=FALSE, fig.align='center', out.width="100%", out.height="100%", fig.cap="Multi-Scale Topographic Index of the Train DTM, Scale 1:4450."}
knitr::include_graphics('C:/Users/kelto/Documents/iSEGMound/analysis/figures/Figure_67.png')
```
As a reminder let's see where the burial mound groups Site ID 5 (black) and Site ID 35 (blue) are located in the Training DTM:  

```{r Figure 68, echo=FALSE, fig.align='center', out.width="50%", out.height="50%", fig.cap="Multi-Scale Topographic Index of the Train DTM with bruial mound groups Site ID 5 and 35. Scale 1:4450."}
knitr::include_graphics('C:/Users/kelto/Documents/iSEGMound/analysis/figures/Figure_68.png')
```
We know from Dobiat et al. 1994, that Site ID 35 was identified as two mounds. As in Chapter 4 discussed, the mounds visible in Figure 68 were possible to be identified on ground.  

# **5.1 Results of the Training DTM**

The workflows applied on the Training DTM are the following: 
5a_iSEG05_WS, 5b_iSEG05_mtpi_WS, 5c_iSEG05_RG, and 5d_iSEG05_mtpi_RG.

Let's plot the results of the Training DTM by segmentation.
Left the Watershed Segmentation based on a DTM (iSEG05_WS, orange segments) and on the SAGA MTPI (iSEG05_mtpi_WS, lilac segments). Right  the Region Growing Segmentation based on a DTM (iSEG05_RG, light blue) and on the SAGA MTPI (iSEG05_mtpi_RG, brown):

```{r Figure 69, echo=FALSE,fig.show='hold', fig.align = "default", out.width="50%", out.height="50%", fig.cap="iSEG WS in orange and iSEG mtpi WS in lilac nect to iSEG RG in light blue and iSEG mtpi RG in brown, Scale 1:4450."}
knitr::include_graphics('C:/Users/kelto/Documents/iSEGMound/analysis/figures/Figure_69_1.png')
knitr::include_graphics('C:/Users/kelto/Documents/iSEGMound/analysis/figures/Figure_69_2.png')
```

The first thing that catches the eyes is that both segmentation methods were able to detect Site ID 35, using the SAGA MTPI. Thus it is already clear from this early step on, that in the case of these scarcely preserved burial mounds it is useful to work with morphometric derivatives. When comparing the two segmentation methods, it is apparent, that Watershed segmentation produces more segments than Region Growing. 

# **5.2 Results of the Training Area**

Before discussing the results of the segmentations, first let's inspect Site ID 7 and Site ID 14. 

Site ID 7 is situated relatively near to the North of Site IDs 5 and 35. The group is constituted of 9 burials, roughly in an elongated line, counted from Southwest to Northeast. When inspecting the mounds, it can be seen that, similar to Site ID 5-9, these are also very near to the forestry commuting routes. Also they already show erosion (mound Site ID 7-5 to 9), mainly in road proximity. This situation has already worsened since 2009/2010, the collection date of the LiDAR data. This burial mound group is similarly preserved such as the average height of the mounds of Site ID 5.

Site ID 14 stretches a little further away to the South and consists of altogether 18 burials. This burial mound group spreads similarly elongated as Site ID 7, although a grouping can be made out in the center region of the group. What is striking about this group is, that many of the mounds - apart from mound 8, which is cut right at the middle - have been just missed or only slightly touched by service roads. The situation of burial mound Site ID 14-8 already indicated, that it is going to be hard to detect this mound properly, because it might be will be difficult to distinguish from the road which is cutting it.  

```{r Figure 70, echo=FALSE, fig.show='hold', fig.align = "default", out.width="50%", out.height="50%", fig.cap="Site ID 7, consituted of 9 burial mounds and Site ID 14, constituted of 18 burial mounds on the DTM, Scale 1:1200 and 1:3100."}
knitr::include_graphics('C:/Users/kelto/Documents/iSEGMound/analysis/figures/Figure_70_1.png')
knitr::include_graphics('C:/Users/kelto/Documents/iSEGMound/analysis/figures/Figure_70_2.png')
```

The workflows applied on the Training Area are the following: 
6a_iSEG05_WS_ta, 6b_iSEG05_mtpi_WS_ta, 6c_iSEG05_RG_ta, 6d_iSEG05_mtpi_RG_ta.

Because the Training Area is too big to really see details when plotting the whole, three plots are going to be displayed: one overview to understand the amount of segments and then the two areas containing burial mounds (Site IDs 5, 7 and 35 and Site ID 14) will be plotted next to each other to see the exact segmentation results. 

Inspecting first the results of the Watershed Segmentation of the Training Area, iSEG05_WS_ta (pink segments) and iSEG05_mtpi_WS_ta (teal segments) are plotted together. It is clearly visible from the overview, that the first impression of the Training DTM is reinforced: more segments are left over by using the SAGA MTPI, which fit to *min* to *max* descriptor range as the segments complying to the burial mound mask. This means on the other hand of course more segments to check, but also more possibility to find previously not known mounds. This will be investigated in the Discussion.  

```{r Figure 71, echo=FALSE, fig.align='center', out.width="50%", out.height="50%", fig.cap="Plotting iSEG WS ta and iSEG mtpi WS ta on the DTM, Scale 1:18000."}
knitr::include_graphics('C:/Users/kelto/Documents/iSEGMound/analysis/figures/Figure_71.png')
```

When "zooming" in to the two areas (Figure 73) containing burial mounds, we can see the following: 
The Northern are (first image of Figure 74) demonstrates again the advantage of using MSTPI: the Site ID 35 is detected by the iSEG mtpi WS workflow, and also a second possible mound, which was only in the profile very slightly visible. Site ID 9 was also detected (in green), although unknowingly: only after the Whitebox MSTPI was checked against Dobiat et al. 1994, became clear that that segment might be Site ID 9. This workflow is better in detecting mounds in this area than the iSEG WS workflow, which missed Site Id 7-5,7-6,7-7 and 7-9). 
Looking at the Southern area (second image of Figure 74), iSEG WS workflow detected from Site ID 14 3 mounds more (14-1, 14-8 and 14-11) than the iSEG mtpi WS workflow, which detected 14-3 (but not detected by iSEG WS).
Although a little less accurate in the southern area, the iSEG mtpi WS workflow is more successful. 

```{r Figure 72, echo=FALSE, fig.show='hold', out.width="50%", fig.align = "default", fig.cap="Plotting iSEG WS ta and iSEG mtpi WS ta on the DTM, Scale 1:3000."}
knitr::include_graphics('C:/Users/kelto/Documents/iSEGMound/analysis/figures/Figure_72_1.png')
knitr::include_graphics('C:/Users/kelto/Documents/iSEGMound/analysis/figures/Figure_72_2.png')
```

Considering the Region Growing Segmentation, the overview tells us, that after filtering generally less segments are left over, which fit to *min* to *max* descriptor range as the segments complying to the burial mound mask:

```{r Figure 73, echo=FALSE, fig.align='center', out.width="50%", out.height="50%", fig.cap="Plotting iSEG RG ta and iSEG mtpi RG ta on the DTM, Scale 1:18000."}
knitr::include_graphics('C:/Users/kelto/Documents/iSEGMound/analysis/figures/Figure_73.png')
```

Going into the details, iSEG_RG_ta is depicted in lime color and iSEG_mtpi_RG in grass green. It is again clear, that using the SAGA MTPI , Site ID 35 is detected, even if only the most visible one.
The iSEG RG workflow does not detect all mounds from Site ID 5 (5-2 is missing and 5-5 is minimally detected), although so far all workflows detected all mounds. In the case of Site ID 7, only 7-1 (at least a part of it), 7-2, 7-3 and 7-8 was detected. 
The iSEG mtpi RG workflow did detect all mounds from Site ID 5, but it failed to detect Site ID 7-4, 7-7 and 7-9.
Between the two workflows iSEG mtpi RG is the more successful. 

```{r Figure 74, echo=FALSE, fig.show='hold', out.width="50%", fig.align = "default", fig.cap="Plotting iSEG RG ta and iSEG mtpi RG ta on the DTM, Scale 1:3000."}
knitr::include_graphics('C:/Users/kelto/Documents/iSEGMound/analysis/figures/Figure_74_1.png')
knitr::include_graphics('C:/Users/kelto/Documents/iSEGMound/analysis/figures/Figure_74_2.png')
```

\newpage
# **5.3 Choosing the best fitting segmentation**

We have seen, that it is clear, that SAGA MTPI as morphometric data preparation methods clearly enhances even the less well visible burial mounds and delineates the mounds more naturally. The remaining question is: how to choose between Watershed and Region growing Segmentation? Which segmentation is better? Two different considerations were investigated: the archaeological decision and the statistical decision. 

From the archaeological point of view the aim is to detect as many burial mounds as possible. This can be of course broken down to the question if we want to find the exact shape of the mounds (in the case of the Training DTM and Training Area) or is the most important to detect as much as possible locations in any shape (e.g. just half or ¾ of a mound is detected) but to detect as many as possible of them. In the case of this Master's, the archaeological choice is definately iSEG_mtpi_WS. 

The only statistical measure which was found the most approximatively fitting is the *Jaccard Index* or *Intersection over Union*. This measure is used in Deep Learning as an evaluation metric to measure the accuracy of an object detection on the original data set. That is,  

```{r Figure 75, echo=FALSE, fig.align='center', out.width="50%", out.height="50%", fig.cap="Values of Intersection over Union (IoU) or 'Jaccard Index'. Source: https://towardsdatascience.com/intersection-over-union-iou-calculation-for-evaluating-an-image-segmentation-model-8b22e2e84686."}
knitr::include_graphics('C:/Users/kelto/Documents/iSEGMound/analysis/figures/Figure_75.png')
```

```{r Table 10, echo=FALSE}
table_10 <- read.csv(here::here('analysis/supplementary-materials/IoU_comparison.csv'))
knitr::kable(table_10, longtable = T, booktabs = TRUE,
  caption = "Demo table")
```
